# @ldesign/auth å®Œæ•´é¡¹ç›®è®¡åˆ’ä¹¦

<div align="center">

# ğŸ” @ldesign/auth v0.1.0

**è®¤è¯æˆæƒç³»ç»Ÿ - JWTã€OAuth 2.0ã€SSOã€MFAï¼Œå®Œæ•´çš„èº«ä»½è®¤è¯è§£å†³æ–¹æ¡ˆ**

[![Version](https://img.shields.io/badge/version-0.1.0-blue.svg)](./CHANGELOG.md)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.7+-blue.svg)](./tsconfig.json)
[![Security](https://img.shields.io/badge/security-enterprise-green.svg)](#å®‰å…¨ç‰¹æ€§)
[![Protocols](https://img.shields.io/badge/protocols-JWT%2BOAuth%2BSSO-blue.svg)](#åŠŸèƒ½æ¸…å•)

</div>

---

## ğŸš€ å¿«é€Ÿå¯¼èˆª

| æƒ³è¦... | æŸ¥çœ‹ç« èŠ‚ | é¢„è®¡æ—¶é—´ |
|---------|---------|---------|
| ğŸ“– äº†è§£è®¤è¯ç³»ç»Ÿ | [é¡¹ç›®æ¦‚è§ˆ](#é¡¹ç›®æ¦‚è§ˆ) | 3 åˆ†é’Ÿ |
| ğŸ” æŸ¥çœ‹å‚è€ƒé¡¹ç›® | [å‚è€ƒé¡¹ç›®åˆ†æ](#å‚è€ƒé¡¹ç›®æ·±åº¦åˆ†æ) | 15 åˆ†é’Ÿ |
| âœ¨ æŸ¥çœ‹åŠŸèƒ½æ¸…å• | [åŠŸèƒ½æ¸…å•](#åŠŸèƒ½æ¸…å•) | 18 åˆ†é’Ÿ |
| ğŸ—ï¸ äº†è§£æ¶æ„ | [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡) | 12 åˆ†é’Ÿ |

---

## ğŸ“Š é¡¹ç›®å…¨æ™¯å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              @ldesign/auth - è®¤è¯æˆæƒå…¨æ™¯                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  ğŸ¯ æ ¸å¿ƒè®¤è¯                                                  â”‚
â”‚  â”œâ”€ ğŸ”‘ JWT è®¤è¯ï¼ˆAccess + Refresh Tokenï¼‰                   â”‚
â”‚  â”œâ”€ ğŸ”„ è‡ªåŠ¨åˆ·æ–°ï¼ˆToken è¿‡æœŸå‰åˆ·æ–°ï¼‰                          â”‚
â”‚  â”œâ”€ ğŸ’¾ çŠ¶æ€æŒä¹…åŒ–ï¼ˆLocalStorage/Cookieï¼‰                    â”‚
â”‚  â”œâ”€ ğŸ‘¤ ç”¨æˆ·ç®¡ç†ï¼ˆUser Info + Rolesï¼‰                        â”‚
â”‚  â””â”€ ğŸ“Š è®¤è¯çŠ¶æ€ï¼ˆisAuthenticated + Loadingï¼‰                â”‚
â”‚                                                              â”‚
â”‚  ğŸŒ OAuth 2.0                                               â”‚
â”‚  â”œâ”€ ğŸ” Authorization Code Flow                             â”‚
â”‚  â”œâ”€ ğŸ« Implicit Flow                                        â”‚
â”‚  â”œâ”€ ğŸ”— PKCE æ”¯æŒ                                            â”‚
â”‚  â””â”€ ğŸŒ ç¤¾äº¤ç™»å½•ï¼ˆGitHub/Google/Facebookï¼‰                   â”‚
â”‚                                                              â”‚
â”‚  ğŸ¢ ä¼ä¸šåŠŸèƒ½                                                 â”‚
â”‚  â”œâ”€ ğŸ”’ SSO å•ç‚¹ç™»å½•                                          â”‚
â”‚  â”œâ”€ ğŸ“± MFA/2FA å¤šå› ç´ è®¤è¯                                   â”‚
â”‚  â”œâ”€ ğŸ” SAML 2.0 æ”¯æŒ                                        â”‚
â”‚  â””â”€ ğŸ¯ RBAC è§’è‰²æƒé™                                         â”‚
â”‚                                                              â”‚
â”‚  ğŸ”§ é«˜çº§åŠŸèƒ½                                                 â”‚
â”‚  â”œâ”€ ğŸŒ WebAuthn ç”Ÿç‰©è¯†åˆ«                                    â”‚
â”‚  â”œâ”€ ğŸ“± è®¾å¤‡ç®¡ç†                                              â”‚
â”‚  â”œâ”€ ğŸ“œ ç™»å½•å†å²                                              â”‚
â”‚  â”œâ”€ ğŸ”” å®‰å…¨å‘Šè­¦                                              â”‚
â”‚  â””â”€ ğŸ“Š å®¡è®¡æ—¥å¿—                                              â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“š å‚è€ƒé¡¹ç›®æ·±åº¦åˆ†æ

### 1. @auth0/auth0-spa-js (â˜…â˜…â˜…â˜…â˜…)

**é¡¹ç›®ä¿¡æ¯**:
- GitHub: https://github.com/auth0/auth0-spa-js
- Stars: 800+
- å›¢é˜Ÿ: Auth0
- å®šä½: SPA è®¤è¯ SDK

**æ ¸å¿ƒç‰¹ç‚¹**:
- âœ… OAuth 2.0 å®Œæ•´å®ç°
- âœ… PKCE æ”¯æŒ
- âœ… Token ç®¡ç†ï¼ˆaccess + refreshï¼‰
- âœ… è‡ªåŠ¨åˆ·æ–°æœºåˆ¶
- âœ… é™é»˜è®¤è¯ï¼ˆiframeï¼‰
- âœ… å®Œå–„çš„é”™è¯¯å¤„ç†

**å€Ÿé‰´è¦ç‚¹**:
1. **Token ç®¡ç†** - access + refresh token åŒ token æœºåˆ¶
2. **è‡ªåŠ¨åˆ·æ–°** - è¿‡æœŸå‰è‡ªåŠ¨åˆ·æ–°
3. **PKCE Flow** - æ›´å®‰å…¨çš„ OAuth æµç¨‹
4. **é™é»˜è®¤è¯** - iframe é™é»˜è·å– token
5. **é”™è¯¯å¤„ç†** - è¯¦ç»†çš„é”™è¯¯ç å’Œæ¶ˆæ¯

**åŠŸèƒ½å€Ÿé‰´**:
- [x] Access + Refresh Tokenï¼ˆå·²å®ç°ï¼‰
- [x] è‡ªåŠ¨åˆ·æ–°ï¼ˆå·²å®ç°ï¼‰
- [ ] PKCE Flow
- [ ] é™é»˜è®¤è¯
- [ ] å®Œå–„é”™è¯¯å¤„ç†

### 2. oidc-client-ts (â˜…â˜…â˜…â˜…â˜…)

**é¡¹ç›®ä¿¡æ¯**:
- GitHub: https://github.com/authts/oidc-client-ts
- Stars: 1,000+
- å®šä½: OpenID Connect å®¢æˆ·ç«¯

**æ ¸å¿ƒç‰¹ç‚¹**:
- âœ… OpenID Connect å®Œæ•´å®ç°
- âœ… å¤šç§ OAuth æµç¨‹
- âœ… ID Token éªŒè¯
- âœ… UserInfo ç«¯ç‚¹
- âœ… Session ç®¡ç†
- âœ… TypeScript å®Œæ•´æ”¯æŒ

**å€Ÿé‰´è¦ç‚¹**:
1. **OIDC æµç¨‹** - Authorization Code + Implicit + Hybrid
2. **ID Token** - JWT ID Token è§£æå’ŒéªŒè¯
3. **UserManager** - ç”¨æˆ·ç®¡ç†ç±»
4. **Session ç›‘æ§** - ä¼šè¯çŠ¶æ€ç›‘æ§
5. **äº‹ä»¶ç³»ç»Ÿ** - userLoaded/userUnloaded/accessTokenExpiring

**åŠŸèƒ½å€Ÿé‰´**:
- [ ] OIDC åè®®æ”¯æŒ
- [ ] ID Token éªŒè¯
- [x] UserManagerï¼ˆå·²æœ‰ AuthManagerï¼‰
- [ ] Session ç›‘æ§
- [ ] äº‹ä»¶ç³»ç»Ÿ

### 3. firebase-auth (â˜…â˜…â˜…â˜…â˜†)

**é¡¹ç›®ä¿¡æ¯**:
- äº§å“: Firebase Authentication
- å›¢é˜Ÿ: Google
- å®šä½: BaaS è®¤è¯æœåŠ¡

**æ ¸å¿ƒç‰¹ç‚¹**:
- âœ… å¤šç§ç™»å½•æ–¹å¼ï¼ˆé‚®ç®±/æ‰‹æœº/ç¤¾äº¤ï¼‰
- âœ… åŒ¿åç™»å½•
- âœ… é‚®ç®±éªŒè¯
- âœ… å¯†ç é‡ç½®
- âœ… å¤šå› ç´ è®¤è¯ï¼ˆMFAï¼‰
- âœ… è®¾å¤‡ç®¡ç†

**å€Ÿé‰´è¦ç‚¹**:
1. **å¤šç§ç™»å½•** - Email/Phone/Google/Facebook/GitHub
2. **é‚®ç®±éªŒè¯** - å‘é€éªŒè¯é‚®ä»¶
3. **å¯†ç é‡ç½®** - å®Œæ•´çš„å¯†ç é‡ç½®æµç¨‹
4. **MFA** - SMS/TOTP å¤šå› ç´ 
5. **æŒä¹…åŒ–** - session/local/none

**åŠŸèƒ½å€Ÿé‰´**:
- [ ] å¤šç§ç™»å½•æ–¹å¼
- [ ] é‚®ç®±éªŒè¯æµç¨‹
- [ ] å¯†ç é‡ç½®æµç¨‹
- [ ] MFA æ”¯æŒ
- [ ] æŒä¹…åŒ–ç­–ç•¥

### 4. next-auth (â˜…â˜…â˜…â˜…â˜…)

**é¡¹ç›®ä¿¡æ¯**:
- GitHub: https://github.com/nextauthjs/next-auth
- Stars: 23,000+
- å®šä½: Next.js è®¤è¯

**æ ¸å¿ƒç‰¹ç‚¹**:
- âœ… ç¤¾äº¤ç™»å½•é›†æˆï¼ˆ50+ æä¾›å•†ï¼‰
- âœ… å‡­è¯ç™»å½•ï¼ˆç”¨æˆ·åå¯†ç ï¼‰
- âœ… é‚®ç®±ç™»å½•ï¼ˆMagic Linkï¼‰
- âœ… Session ç®¡ç†
- âœ… JWT ç­–ç•¥
- âœ… æ•°æ®åº“é€‚é…å™¨

**å€Ÿé‰´è¦ç‚¹**:
1. **Provider ç³»ç»Ÿ** - ç»Ÿä¸€çš„ç™»å½•æä¾›å•†æ¥å£
2. **Callbacks** - ä¸°å¯Œçš„å›è°ƒé’©å­
3. **Session ç­–ç•¥** - JWT vs Database
4. **Adapter æ¨¡å¼** - æ•°æ®åº“é€‚é…å™¨
5. **é…ç½®åŒ–** - å£°æ˜å¼é…ç½®

**åŠŸèƒ½å€Ÿé‰´**:
- [ ] Provider ç³»ç»Ÿ
- [ ] ç¤¾äº¤ç™»å½•é›†æˆ
- [ ] Callbacks é’©å­
- [ ] Session ç­–ç•¥
- [ ] Adapter æ¨¡å¼

### 5. passport.js (â˜…â˜…â˜…â˜…â˜†)

**é¡¹ç›®ä¿¡æ¯**:
- GitHub: https://github.com/jaredhanson/passport
- Stars: 22,000+
- å®šä½: Node.js è®¤è¯ä¸­é—´ä»¶

**æ ¸å¿ƒç‰¹ç‚¹**:
- âœ… ç­–ç•¥ï¼ˆStrategyï¼‰æ¶æ„
- âœ… 500+ ç­–ç•¥æ’ä»¶
- âœ… ä¼šè¯ç®¡ç†
- âœ… åºåˆ—åŒ–/ååºåˆ—åŒ–
- âœ… ä¸­é—´ä»¶æ¨¡å¼

**å€Ÿé‰´è¦ç‚¹**:
1. **Strategy æ¨¡å¼** - å¯æ’æ‹”è®¤è¯ç­–ç•¥
2. **ä¸­é—´ä»¶** - Express/Koa é›†æˆ
3. **åºåˆ—åŒ–** - ç”¨æˆ·å¯¹è±¡åºåˆ—åŒ–
4. **ç”Ÿæ€ä¸°å¯Œ** - å¤§é‡ç¤¾åŒºç­–ç•¥
5. **çµæ´»é…ç½®** - é«˜åº¦å¯å®šåˆ¶

**åŠŸèƒ½å€Ÿé‰´**:
- [ ] Strategy æ¨¡å¼
- [ ] ä¸­é—´ä»¶æ”¯æŒ
- [ ] åºåˆ—åŒ–æœºåˆ¶

### å‚è€ƒé¡¹ç›®åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ | auth0 | oidc-client | firebase | next-auth | passport | **@ldesign/auth** |
|------|-------|-------------|----------|-----------|----------|-------------------|
| JWT | âœ… | âœ… | âœ… | âœ… | âš ï¸ | âœ… |
| OAuth 2.0 | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… è®¡åˆ’ |
| OIDC | âœ… | âœ… | âš ï¸ | âš ï¸ | âš ï¸ | âœ… è®¡åˆ’ |
| SSO | âœ… | âœ… | âš ï¸ | âš ï¸ | âš ï¸ | âœ… è®¡åˆ’ |
| MFA | âœ… | âš ï¸ | âœ… | âš ï¸ | âŒ | âœ… è®¡åˆ’ |
| ç¤¾äº¤ç™»å½• | âœ… | âš ï¸ | âœ… | âœ… | âœ… | âœ… è®¡åˆ’ |
| TypeScript | âœ… | âœ… | âœ… | âœ… | âš ï¸ | âœ… |
| æµè§ˆå™¨ | âœ… | âœ… | âœ… | âœ… | âŒ | âœ… |
| è‡ªåŠ¨åˆ·æ–° | âœ… | âœ… | âœ… | âš ï¸ | âŒ | âœ… |
| Bundle å¤§å° | 32KB | 45KB | å¤§ | N/A | ä¸­ | **<40KB** ğŸ¯ |

---

## âœ¨ åŠŸèƒ½æ¸…å•

### P0 æ ¸å¿ƒåŠŸèƒ½ï¼ˆ15é¡¹ï¼‰

#### JWT è®¤è¯

- [x] **AuthManager æ ¸å¿ƒ** - è®¤è¯ç®¡ç†å™¨ï¼ˆå‚è€ƒ: auth0ï¼‰
  - âœ… login() - ç™»å½•
  - âœ… logout() - ç™»å‡º
  - âœ… getUser() - è·å–ç”¨æˆ·
  - âœ… getAccessToken() - è·å–Token
  - âœ… isAuthenticated() - æ£€æŸ¥è®¤è¯çŠ¶æ€

- [x] **Token ç®¡ç†** - åŒTokenæœºåˆ¶ï¼ˆå‚è€ƒ: auth0ï¼‰
  - âœ… Access Token - çŸ­æœŸè®¿é—®ä»¤ç‰Œ
  - âœ… Refresh Token - é•¿æœŸåˆ·æ–°ä»¤ç‰Œ
  - âœ… Token å­˜å‚¨ï¼ˆlocalStorageï¼‰
  - âœ… Token è¿‡æœŸæ£€æµ‹

- [x] **è‡ªåŠ¨åˆ·æ–°** - Token è‡ªåŠ¨åˆ·æ–°ï¼ˆå‚è€ƒ: auth0ï¼‰
  - âœ… è¿‡æœŸå‰è‡ªåŠ¨åˆ·æ–°
  - âœ… refreshThreshold é…ç½®
  - âœ… åˆ·æ–°å¤±è´¥å¤„ç†
  - âœ… å®šæ—¶å™¨ç®¡ç†

- [x] **çŠ¶æ€ç®¡ç†** - è®¤è¯çŠ¶æ€ï¼ˆå‚è€ƒ: firebaseï¼‰
  - âœ… isAuthenticated - æ˜¯å¦è®¤è¯
  - âœ… user - å½“å‰ç”¨æˆ·
  - âœ… token - Token ä¿¡æ¯
  - âœ… loading - åŠ è½½çŠ¶æ€
  - âœ… error - é”™è¯¯ä¿¡æ¯

- [x] **çŠ¶æ€æŒä¹…åŒ–** - æœ¬åœ°å­˜å‚¨ï¼ˆå‚è€ƒ: æ‰€æœ‰ï¼‰
  - âœ… localStorage å­˜å‚¨
  - [ ] Cookie å­˜å‚¨ï¼ˆå¯é€‰ï¼‰
  - [ ] sessionStorageï¼ˆå¯é€‰ï¼‰
  - [x] è‡ªåŠ¨æ¢å¤çŠ¶æ€

- [ ] **ä¼šè¯ç®¡ç†** - Session ç®¡ç†ï¼ˆå‚è€ƒ: oidc-clientï¼‰
  - ä¼šè¯è¶…æ—¶
  - ä¼šè¯å»¶é•¿
  - å¤šæ ‡ç­¾é¡µåŒæ­¥

#### ç™»å½•æµç¨‹

- [x] **ç”¨æˆ·åå¯†ç ç™»å½•** - åŸºç¡€ç™»å½•ï¼ˆå‚è€ƒ: æ‰€æœ‰ï¼‰
  - âœ… ç™»å½•æ¥å£
  - âœ… å‡­è¯éªŒè¯
  - [ ] è®°ä½æˆ‘åŠŸèƒ½

- [ ] **é‚®ç®±ç™»å½•** - æ— å¯†ç ç™»å½•ï¼ˆå‚è€ƒ: next-authï¼‰
  - Magic Link
  - OTP éªŒè¯ç 

- [ ] **æ‰‹æœºå·ç™»å½•** - çŸ­ä¿¡éªŒè¯ï¼ˆå‚è€ƒ: firebaseï¼‰
  - çŸ­ä¿¡éªŒè¯ç 
  - éªŒè¯ç éªŒè¯

### P1 é«˜çº§åŠŸèƒ½ï¼ˆ18é¡¹ï¼‰

#### OAuth 2.0

- [ ] **Authorization Code Flow** - æ ‡å‡†æµç¨‹ï¼ˆå‚è€ƒ: oidc-clientï¼‰
  - æˆæƒè¯·æ±‚
  - æˆæƒç äº¤æ¢
  - State å‚æ•°éªŒè¯
  - PKCE æ”¯æŒ

- [ ] **Implicit Flow** - ç®€åŒ–æµç¨‹ï¼ˆå‚è€ƒ: auth0ï¼‰
  - ç›´æ¥è¿”å› token
  - æµè§ˆå™¨å‹å¥½

- [ ] **OAuth Provider** - æä¾›å•†ç³»ç»Ÿï¼ˆå‚è€ƒ: next-authï¼‰
  - GitHub Provider
  - Google Provider
  - Facebook Provider
  - è‡ªå®šä¹‰ Provider
  - ç»Ÿä¸€æ¥å£

#### OpenID Connect

- [ ] **OIDC åè®®** - OpenID Connectï¼ˆå‚è€ƒ: oidc-clientï¼‰
  - Discovery ç«¯ç‚¹
  - UserInfo ç«¯ç‚¹
  - ID Token éªŒè¯
  - Claims è§£æ

#### SSO å•ç‚¹ç™»å½•

- [ ] **SSO æ”¯æŒ** - ä¼ä¸š SSOï¼ˆå‚è€ƒ: auth0ï¼‰
  - SAML 2.0 åè®®
  - CAS åè®®
  - LDAP é›†æˆ
  - AD é›†æˆ

#### å¤šå› ç´ è®¤è¯

- [ ] **MFA/2FA** - å¤šå› ç´ è®¤è¯ï¼ˆå‚è€ƒ: firebaseï¼‰
  - SMS éªŒè¯ç 
  - TOTPï¼ˆGoogle Authenticatorï¼‰
  - é‚®ç®±éªŒè¯ç 
  - ç”Ÿç‰©è¯†åˆ«ï¼ˆWebAuthnï¼‰

#### ç¤¾äº¤ç™»å½•

- [ ] **ç¤¾äº¤è´¦å·é›†æˆ** - ç¬¬ä¸‰æ–¹ç™»å½•ï¼ˆå‚è€ƒ: next-authï¼‰
  - GitHub OAuth
  - Google OAuth
  - Facebook OAuth
  - Twitter OAuth
  - å¾®ä¿¡/QQ/å¾®åš
  - Apple Sign In

#### å¯†ç ç®¡ç†

- [ ] **å¯†ç é‡ç½®** - å®Œæ•´æµç¨‹ï¼ˆå‚è€ƒ: firebaseï¼‰
  - å‘é€é‡ç½®é‚®ä»¶
  - é‡ç½® Token éªŒè¯
  - å¯†ç æ›´æ–°
  - é‡ç½®æˆåŠŸé€šçŸ¥

- [ ] **é‚®ç®±éªŒè¯** - é‚®ç®±éªŒè¯æµç¨‹ï¼ˆå‚è€ƒ: firebaseï¼‰
  - å‘é€éªŒè¯é‚®ä»¶
  - éªŒè¯ Token
  - æ ‡è®°å·²éªŒè¯

- [ ] **å¯†ç ç­–ç•¥** - å®‰å…¨ç­–ç•¥ï¼ˆå‚è€ƒ: auth0ï¼‰
  - å¯†ç å¼ºåº¦è¦æ±‚
  - å¯†ç å†å²
  - å¯†ç è¿‡æœŸ
  - å¯†ç é‡è¯•é™åˆ¶

### P2 æ‰©å±•åŠŸèƒ½ï¼ˆ10é¡¹ï¼‰

#### ç”Ÿç‰©è¯†åˆ«

- [ ] **WebAuthn** - ç”Ÿç‰©è¯†åˆ«ç™»å½•
  - æŒ‡çº¹è¯†åˆ«
  - é¢éƒ¨è¯†åˆ«
  - ç¡¬ä»¶å¯†é’¥ï¼ˆYubiKeyï¼‰
  - å¹³å°è®¤è¯å™¨

#### è®¾å¤‡ç®¡ç†

- [ ] **è®¾å¤‡è¿½è¸ª** - ç™»å½•è®¾å¤‡ç®¡ç†
  - è®¾å¤‡åˆ—è¡¨
  - è®¾å¤‡ä¿¡ä»»
  - è®¾å¤‡æ³¨é”€
  - å¯ç–‘è®¾å¤‡å‘Šè­¦

#### å®‰å…¨å®¡è®¡

- [ ] **ç™»å½•å†å²** - ç™»å½•è®°å½•
  - ç™»å½•æ—¶é—´
  - ç™»å½•IP
  - ç™»å½•è®¾å¤‡
  - ç™»å½•ä½ç½®

- [ ] **å®‰å…¨å®¡è®¡** - å®¡è®¡æ—¥å¿—
  - æ“ä½œè®°å½•
  - æƒé™å˜æ›´
  - æ•æ„Ÿæ“ä½œ

#### é«˜çº§ç‰¹æ€§

- [ ] **é£é™©è¯„ä¼°** - ç™»å½•é£é™©
  - å¼‚å¸¸ç™»å½•æ£€æµ‹
  - IP é»‘åå•
  - é¢‘ç‡é™åˆ¶

- [ ] **è´¦å·ä¿æŠ¤** - å®‰å…¨ä¿æŠ¤
  - è´¦å·é”å®š
  - ç™»å½•é™åˆ¶
  - éªŒè¯ç 

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  @ldesign/auth                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ AuthManager  â”‚â”€â”€â”€â”€â–¶â”‚ TokenManager â”‚               â”‚
â”‚  â”‚              â”‚     â”‚              â”‚               â”‚
â”‚  â”‚ - login()    â”‚     â”‚ - refresh()  â”‚               â”‚
â”‚  â”‚ - logout()   â”‚     â”‚ - validate() â”‚               â”‚
â”‚  â”‚ - getUser()  â”‚     â”‚ - store()    â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚         â”‚                     â”‚                       â”‚
â”‚         â–¼                     â–¼                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ StateManager â”‚     â”‚StorageManagerâ”‚               â”‚
â”‚  â”‚              â”‚     â”‚              â”‚               â”‚
â”‚  â”‚ - state      â”‚     â”‚ - save()     â”‚               â”‚
â”‚  â”‚ - subscribe()â”‚     â”‚ - load()     â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚         OAuth/OIDC Module                  â”‚      â”‚
â”‚  â”œâ”€ OAuthManager                               â”‚      â”‚
â”‚  â”œâ”€ OIDCManager                                â”‚      â”‚
â”‚  â”œâ”€ Provider ç³»ç»Ÿ                               â”‚      â”‚
â”‚  â””â”€ Flow å¤„ç†å™¨                                 â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚         MFA Module                         â”‚      â”‚
â”‚  â”œâ”€ SMS Verifier                               â”‚      â”‚
â”‚  â”œâ”€ TOTP Verifier                              â”‚      â”‚
â”‚  â””â”€ WebAuthn Handler                           â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç±»è®¾è®¡

```typescript
class AuthManager {
  // è®¤è¯æ–¹æ³•
  login(credentials: LoginCredentials): Promise<void>
  logout(): Promise<void>
  refreshToken(): Promise<void>
  
  // çŠ¶æ€æŸ¥è¯¢
  getUser(): User | null
  getAccessToken(): string | null
  isAuthenticated(): boolean
  
  // çŠ¶æ€è®¢é˜…
  subscribe(listener: (state: AuthState) => void): () => void
  
  // é…ç½®
  setAuth(user: User, token: TokenInfo): Promise<void>
}

class TokenManager {
  refresh(refreshToken: string): Promise<TokenInfo>
  validate(token: string): boolean
  decode(token: string): TokenPayload
  store(token: TokenInfo): void
  load(): TokenInfo | null
}

class OAuthManager {
  authorize(provider: OAuthProvider): Promise<void>
  callback(code: string, state: string): Promise<TokenInfo>
  buildAuthUrl(provider: OAuthProvider): string
}
```

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæŠ€æœ¯

- **TypeScript 5.7+**
- **JWT** (JSON Web Tokens)
- **OAuth 2.0** åè®®
- **OpenID Connect** åè®®

### å†…éƒ¨ä¾èµ–

```json
{
  "dependencies": {
    "@ldesign/http": "workspace:*",     // HTTP è¯·æ±‚
    "@ldesign/crypto": "workspace:*",   // åŠ å¯†è§£å¯†
    "@ldesign/router": "workspace:*",   // è·¯ç”±å®ˆå«
    "@ldesign/cache": "workspace:*",    // Token ç¼“å­˜
    "@ldesign/shared": "workspace:*"    // å·¥å…·å‡½æ•°
  }
}
```

---

## ğŸ—ºï¸ å¼€å‘è·¯çº¿å›¾

### v0.1.0 - MVPï¼ˆå½“å‰ï¼‰âœ…

**å·²å®Œæˆ**:
- [x] AuthManager æ ¸å¿ƒ
- [x] JWT åŸºç¡€è®¤è¯
- [x] Token ç®¡ç†ï¼ˆaccess + refreshï¼‰
- [x] è‡ªåŠ¨åˆ·æ–°
- [x] çŠ¶æ€ç®¡ç†
- [x] æŒä¹…åŒ–ï¼ˆlocalStorageï¼‰

**å¾…å®Œå–„**:
- [ ] å®Œæ•´æ–‡æ¡£
- [ ] å•å…ƒæµ‹è¯•
- [ ] é”™è¯¯å¤„ç†å®Œå–„

### v0.2.0 - OAuthï¼ˆ4-5å‘¨ï¼‰

**åŠŸèƒ½**:
- [ ] OAuth 2.0 å®Œæ•´å®ç°
- [ ] PKCE æ”¯æŒ
- [ ] ç¤¾äº¤ç™»å½•ï¼ˆGitHub/Googleï¼‰
- [ ] Provider ç³»ç»Ÿ
- [ ] å®Œæ•´æµ‹è¯•

### v0.3.0 - ä¼ä¸šåŠŸèƒ½ï¼ˆ5-6å‘¨ï¼‰

**åŠŸèƒ½**:
- [ ] SSO å•ç‚¹ç™»å½•
- [ ] SAML 2.0
- [ ] MFA/2FA
- [ ] å¯†ç é‡ç½®æµç¨‹
- [ ] é‚®ç®±éªŒè¯æµç¨‹

### v1.0.0 - å®Œæ•´å®‰å…¨ï¼ˆ10-12å‘¨ï¼‰

**åŠŸèƒ½**:
- [ ] WebAuthn ç”Ÿç‰©è¯†åˆ«
- [ ] è®¾å¤‡ç®¡ç†
- [ ] ç™»å½•å†å²
- [ ] å®‰å…¨å®¡è®¡
- [ ] é£é™©è¯„ä¼°

---

## ğŸ“‹ è¯¦ç»†ä»»åŠ¡åˆ†è§£

### Week 1-2: v0.1.0 å®Œå–„

#### Week 1
- [ ] JWT è§£æå™¨ï¼ˆ2å¤©ï¼‰
  - JWT decode
  - Payload éªŒè¯
  - è¿‡æœŸæ£€æµ‹
  
- [ ] é”™è¯¯å¤„ç†ï¼ˆ2å¤©ï¼‰
  - é”™è¯¯ç å®šä¹‰
  - é”™è¯¯ç±»å‹
  - é”™è¯¯æ¶ˆæ¯

- [ ] æ–‡æ¡£ï¼ˆ1å¤©ï¼‰

#### Week 2
- [ ] å•å…ƒæµ‹è¯•ï¼ˆ3å¤©ï¼‰
- [ ] é›†æˆæµ‹è¯•ï¼ˆ2å¤©ï¼‰

### Week 3-7: v0.2.0 OAuth

#### Week 3-4: OAuth æ ¸å¿ƒ
- [ ] OAuth æµç¨‹ï¼ˆ10å¤©ï¼‰
  - Authorization Code
  - PKCE
  - State éªŒè¯

#### Week 5: Provider ç³»ç»Ÿ
- [ ] GitHub Providerï¼ˆ3å¤©ï¼‰
- [ ] Google Providerï¼ˆ2å¤©ï¼‰

#### Week 6-7: æµ‹è¯•å’Œæ–‡æ¡£
- [ ] å®Œæ•´æµ‹è¯•ï¼ˆ5å¤©ï¼‰
- [ ] OAuth æ–‡æ¡£ï¼ˆ5å¤©ï¼‰

---

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•

**è¦†ç›–ç‡**: >85%

**æµ‹è¯•å†…å®¹**:
- AuthManager æ‰€æœ‰æ–¹æ³•
- Token ç®¡ç†
- çŠ¶æ€ç®¡ç†
- æŒä¹…åŒ–

### E2E æµ‹è¯•

**åœºæ™¯**:
- å®Œæ•´ç™»å½•æµç¨‹
- Token åˆ·æ–°æµç¨‹
- ç™»å‡ºæµç¨‹
- OAuth æµç¨‹

---

## ğŸ“Š æ€§èƒ½ç›®æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ |
|------|------|
| Bundle å¤§å° | <40KB |
| ç™»å½•è€—æ—¶ | <500ms |
| Token åˆ·æ–° | <200ms |
| çŠ¶æ€æ¢å¤ | <50ms |

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**åˆ›å»ºæ—¶é—´**: 2025-10-22






